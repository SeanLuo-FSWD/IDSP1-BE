(this.webpackJsonptownsquare=this.webpackJsonptownsquare||[]).push([[0],{26:function(e,t,n){e.exports={navBar:"Navbar_navBar__27Cf3",navBar__item:"Navbar_navBar__item__38gja"}},48:function(e,t,n){e.exports={error:"Error_error__T_9Pn"}},49:function(e,t,n){e.exports={post:"Post_post__3hqZB"}},64:function(e,t,n){},65:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var s=n(0),c=n(22),r=n(20),o=n.n(r),a=(n(64),n(5)),i=(n(65),Object(s.createContext)({})),l=n(21),u=n(3),j=n(16),d=n(17),b=n.n(d),p="http://idsp.link/api",O=n(48),m=n.n(O),h=n(1),f=function(e){return Object(h.jsx)("div",{children:Object(h.jsx)("h2",{className:m.a.error,children:e.message})})};var x=function(){var e=Object(s.useContext)(i),t=e.signUpStatus,n=e.setSignUpStatus,c=e.setUsername,r=e.setIsAuthenticated,o=e.setUserId,d=Object(s.useState)(""),O=Object(a.a)(d,2),m=O[0],x=O[1],g=Object(s.useState)({email:"",password:""}),v=Object(a.a)(g,2),_=v[0],k=v[1],w=function(e){var t=e.target.name,n=e.target.value;k(Object(u.a)(Object(u.a)({},_),{},Object(l.a)({},t,n)))};return Object(h.jsxs)("div",{children:[t&&Object(h.jsx)("h2",{children:"Sign up success"}),m&&Object(h.jsx)(f,{message:m}),Object(h.jsx)("h2",{children:"Please login"}),Object(h.jsx)("h4",{children:"bob@bob.com"}),Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:"uname",children:Object(h.jsx)("b",{children:"email"})}),Object(h.jsx)("input",{type:"text",placeholder:"Enter email",name:"email",required:!0,value:_.email,onChange:w}),Object(h.jsx)("label",{htmlFor:"psw",children:Object(h.jsx)("b",{children:"Password"})}),Object(h.jsx)("input",{type:"password",placeholder:"Enter Password",name:"password",required:!0,value:_.password,onChange:w}),Object(h.jsx)("button",{onClick:function(e){(e.preventDefault(),_.email&&_.password)?function(e,t){b.a.post("".concat(p,"/user/login"),e,{headers:{"Content-Type":"application/json"}}).then((function(e){console.log("post login response"),console.log(e),t(null,e)})).catch((function(e){console.log("post login error"),console.log(e),t(e)}))}({email:_.email,password:_.password},(function(e,t){e?(console.log(e),x(e.message)):(x(""),r(!0),n(!1),console.log("login result message"),console.log(t),c(t.data.username),o(t.data.userId))})):x("You are missing some credentials")},children:"Login"})]}),Object(h.jsx)("div",{children:Object(h.jsx)("ul",{children:Object(h.jsx)("li",{children:Object(h.jsx)(j.b,{to:"/register",children:"Register"})})})})]})},g=function(e){var t=Object(s.useContext)(i).isAuthenticated;return Object(h.jsx)(h.Fragment,{children:t?e.children:Object(h.jsx)(x,{})})},v=n(4),_=n(7),k=n.n(_),w=n(14),C="https://comp2350-week6-sean-luo.herokuapp.com",I=function(){var e=Object(w.a)(k.a.mark((function e(t,n){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b.a.post("".concat(C,"/ts/create_post"),{post_obj:t}).then((function(e){console.log("postCreate response"),console.log(e),n(null,e.data)})).catch((function(e){console.log("postCreate error"),console.log(e),n(e)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),S=function(){var e=Object(w.a)(k.a.mark((function e(t){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("".concat(C,"/ts/posts"));case 3:n=e.sent,t(null,n.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(w.a)(k.a.mark((function e(t,n){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b.a.post("".concat(C,"/ts/like_post"),t).then((function(e){console.log("likePost response"),console.log(e),n(null,e.data)})).catch((function(e){console.log("likePost error"),console.log(e),n(e)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),E=function(){var e=Object(w.a)(k.a.mark((function e(t,n){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("comment_objcomment_objcomment_objcomment_obj"),console.log(t),b.a.post("".concat(C,"/ts/add_comment"),{userId:t.userId,id:t.id,username:t.username,createdAt:t.createdAt,message:t.message,postId:t.postId}).then((function(e){console.log("add_comment response"),console.log(e),n(null,e.data)})).catch((function(e){console.log("add_comment error"),console.log(e),n(e)}));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N="FEED_FETCH",P="API_ERROR",A="COMMENT_ADD",F="POST_LIKE",L="POST_CREATE",U=n(50),T=n.n(U),D=n(51),B=n.n(D),R=function(e){var t=Object(s.useState)(!1),n=Object(a.a)(t,2),c=n[0],r=n[1];return Object(h.jsxs)("div",{children:[c&&Object(h.jsx)("ul",{children:(console.log("like like like"),console.log(e.like_arr),e.like_arr.map((function(e){return console.log(e),Object(h.jsx)("li",{children:e.username},e.id)})))}),Object(h.jsx)("h4",{onClick:function(){return r(!c)},children:e.like_arr.length})]})},q=function(e){return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{className:"flex--space-between",children:[Object(h.jsx)("h3",{children:e.username}),Object(h.jsx)("h4",{children:e.createdAt})]}),Object(h.jsx)("h4",{style:{paddingLeft:"20px"},children:e.message})]})})},M=n(28),H=n.n(M),J=n(24),K=n(49),W=n.n(K),Y=Object(c.b)(null,(function(e){return{onPostComment:function(t){return e(function(e){return function(){var t=Object(w.a)(k.a.mark((function t(n){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:E(e,(function(e,t){n(e?{type:P,error:e.message}:{type:A,comment_obj:t})}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))},onLikeComment:function(t){return e(function(e){return function(){var t=Object(w.a)(k.a.mark((function t(n){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:y(e,(function(e,t){n(e?{type:P,error:e.message}:{type:F,post_like:t})}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))}}}))((function(e){var t=Object(s.useContext)(i),n=t.username,c=t.userId,r=Object(s.useState)(""),o=Object(a.a)(r,2),l=o[0],j=o[1],d=Object(s.useState)(!1),b=Object(a.a)(d,2),p=b[0],O=b[1],m=function(t){var s={id:Object(J.v4)(),userId:c,username:n,postId:e.id,isLike:t};e.onLikeComment(s)};return Object(h.jsxs)("div",{className:W.a.post,children:[Object(h.jsxs)("div",{className:"flex--space-between",children:[Object(h.jsx)("h4",{children:e.userName}),Object(h.jsx)("h4",{children:e.createdAt})]}),Object(h.jsx)("h2",{children:e.title}),Object(h.jsx)("h5",{style:{paddingLeft:"20px"},children:e.message}),Object(h.jsxs)("div",{className:"flex--space-between",children:[Object(h.jsxs)("div",{className:"flex",children:[0!=H.a.filter(e.likes,(function(e){return e.userId==c})).length?Object(h.jsx)(T.a,{onClick:function(){m(!1)}}):Object(h.jsx)(B.a,{onClick:function(){m(!0)}}),Object(h.jsx)(R,{like_arr:e.likes})]}),Object(h.jsx)("div",{children:Object(h.jsx)("h4",{style:{textDecoration:"underline"},onClick:function(){return O(!p)},children:"See Comments"})})]}),p&&Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{children:e.commentList.map((function(e){return Object(h.jsx)(q,Object(u.a)({},e),e.id)}))}),Object(h.jsxs)("form",{onSubmit:function(t){t.preventDefault();var s={userId:c,username:n,createdAt:new Date,message:l,id:Object(J.v4)(),postId:e.id};e.onPostComment(s)},children:[Object(h.jsx)("input",{type:"text",id:"comment",name:"comment",value:l,onChange:function(e){return j(e.target.value)}}),Object(h.jsx)("button",{type:"submit",children:"add Comment"})]})]})]},e.postId)})),G=Object(c.b)((function(e){return{feed:e.feedState,error:(t=e.feedState,t.error)};var t}),(function(e){return{onFetchFeed:function(){return e(function(){var e=Object(w.a)(k.a.mark((function e(t){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S((function(e,n){e?t({type:P,error:e.message}):(n.reverse(),t({type:N,posts:n}))}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},onPostCreate:function(t){return e(function(e){return function(){var t=Object(w.a)(k.a.mark((function t(n){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:I(e,(function(e,t){n(e?{type:P,error:e.message}:{type:L,post_obj_res:t})}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))}}}))((function(e){var t=Object(s.useContext)(i).username,n=Object(s.useState)(""),c=Object(a.a)(n,2),r=c[0],o=c[1],l=Object(s.useState)(""),j=Object(a.a)(l,2),d=j[0],b=j[1];Object(s.useEffect)((function(){e.onFetchFeed()}),[]);return Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{children:"Posts feed page"}),Object(h.jsxs)("h2",{children:["Welcome: ",t]}),Object(h.jsx)("div",{children:Object(h.jsxs)("form",{onSubmit:function(n){n.preventDefault();var s={id:Object(J.v4)(),userName:t,createdAt:new Date,title:r,message:d,likes:[],commentList:[]};e.onPostCreate(s)},children:["Title:"," ",Object(h.jsx)("input",{type:"text",name:"title",value:r,onChange:function(e){return o(e.target.value)}}),Object(h.jsx)("textarea",{rows:4,cols:50,name:"message",value:d,onChange:function(e){return b(e.target.value)}}),Object(h.jsx)("input",{type:"submit"})]})}),Object(h.jsx)("div",{children:e.feed.error?Object(h.jsx)(f,{message:e.feed.error}):e.feed.posts.length>0?e.feed.posts.map((function(e){return Object(h.jsx)(Y,Object(u.a)({},e),e.id)})):Object(h.jsx)("div",{children:Object(h.jsx)("h2",{children:"loading..."})})})]})}));var Z=function(){var e=Object(s.useContext)(i).username;return Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{children:"Users page"}),Object(h.jsxs)("h2",{children:["Welcome: ",e," "]})]})},z=function(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(v.a,{exact:!0,path:"/",children:Object(h.jsx)(G,{})}),Object(h.jsx)(v.a,{path:"/users",children:Object(h.jsx)(Z,{})})]})},Q=function(){var e=Object(v.f)(),t=Object(s.useState)({username:"",email:"",password:""}),n=Object(a.a)(t,2),c=n[0],r=n[1],o=Object(s.useContext)(i).setSignUpStatus,j=Object(s.useState)(""),d=Object(a.a)(j,2),O=d[0],m=d[1],x=function(e){var t=e.target.name,n=e.target.value;r(Object(u.a)(Object(u.a)({},c),{},Object(l.a)({},t,n)))};return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("article",{className:"form",children:[O&&Object(h.jsx)(f,{message:O}),Object(h.jsxs)("form",{children:[Object(h.jsxs)("div",{className:"form-control",children:[Object(h.jsx)("label",{htmlFor:"username",children:"username : "}),Object(h.jsx)("input",{type:"username",id:"username",name:"username",value:c.username,onChange:x})]}),Object(h.jsxs)("div",{className:"form-control",children:[Object(h.jsx)("label",{htmlFor:"email",children:"Email : "}),Object(h.jsx)("input",{type:"email",id:"email",name:"email",value:c.email,onChange:x})]}),Object(h.jsxs)("div",{className:"form-control",children:[Object(h.jsx)("label",{htmlFor:"password",children:"password : "}),Object(h.jsx)("input",{type:"password",id:"password",name:"password",value:c.password,onChange:x})]}),Object(h.jsx)("button",{type:"submit",onClick:function(t){(t.preventDefault(),c.email&&c.password&&c.username)?function(e,t){b.a.post("".concat(p,"/user/signUp"),e).then((function(e){console.log("post register response"),console.log(e),t(null,e)})).catch((function(e){console.log("post register error"),console.log(e),t(e)}))}({username:c.username,email:c.email,password:c.password},(function(t,n){t?(console.log(t),m(t.message)):(m(""),o(!0),console.log("registration result message"),console.log(n.data.message),e.push("/"))})):m("You are missing some credentials")},children:"Register"})]})]})})},V=n(26),X=n.n(V);var $=function(){var e=Object(s.useState)(""),t=Object(a.a)(e,2),n=(t[0],t[1]),c=Object(s.useContext)(i),r=c.setUsername,o=c.setIsAuthenticated,l=c.setUserId;return Object(h.jsxs)("div",{className:"".concat(X.a.navBar," flex--space-around"),children:[Object(h.jsx)("div",{className:X.a.navBar__item,children:Object(h.jsx)(j.b,{to:"/",children:"Home"})}),Object(h.jsx)("div",{className:X.a.navBar__item,children:Object(h.jsx)(j.b,{to:"/users",children:"Users"})}),Object(h.jsx)("div",{className:X.a.navBar__item,children:Object(h.jsx)("button",{onClick:function(){var e;e=function(e,t){e?(console.log(e),n(e.message)):(n(""),console.log("LOGOUT result message"),console.log(t),r(""),l(""),o(!1))},b.a.get("".concat(p,"/user/logout")).then((function(t){console.log("post register response"),console.log(t),e(null,t)})).catch((function(t){console.log("post logout error"),console.log(t),e(t)}))},children:"Logout"})})]})},ee=function(){return Object(h.jsx)(j.a,{children:Object(h.jsxs)(v.c,{children:[Object(h.jsx)(v.a,{path:"/register",children:Object(h.jsx)(Q,{})}),Object(h.jsxs)(g,{children:[Object(h.jsx)($,{}),Object(h.jsx)(z,{})]})]})})};var te=function(){var e=Object(s.useState)(!1),t=Object(a.a)(e,2),n=t[0],c=t[1],r=Object(s.useState)(""),o=Object(a.a)(r,2),l=o[0],u=o[1],j=Object(s.useState)(""),d=Object(a.a)(j,2),b=d[0],p=d[1],O=Object(s.useState)(!1),m=Object(a.a)(O,2),f=m[0],x=m[1];return Object(h.jsx)(i.Provider,{value:{userId:l,setUserId:u,isAuthenticated:n,username:b,setUsername:p,setIsAuthenticated:c,signUpStatus:f,setSignUpStatus:x},children:Object(h.jsx)(ee,{})})},ne=n(25),se=n(52),ce=n(53),re=n(29),oe={posts:[],error:null};var ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:console.log("case POST_CREATE"),console.log(t.post_obj_res);var n=Object(u.a)(Object(u.a)({},e),{},{posts:[t.post_obj_res.post_obj].concat(Object(re.a)(e.posts))});return n;case N:console.log("case FEED_FETCH"),console.log(t.posts);var s=Object(u.a)(Object(u.a)({},e),{},{posts:t.posts});return s;case P:return console.log("case API_ERROR"),console.log(t.error),Object(u.a)(Object(u.a)({},e),{},{error:t.error});case F:console.log("case POST_LIKE");for(var c=[],r=0;r<e.posts.length;r++)if(e.posts[r].id==t.post_like.postId){c=t.post_like.isLike?[].concat(Object(re.a)(e.posts[r].likes),[{id:t.post_like.id,userId:t.post_like.userId,postId:t.post_like.postId,username:t.post_like.username}]):H.a.filter(e.posts[r].likes,(function(e){return e.userId!=t.post_like.userId}));break}var o=e.posts.map((function(e){return e.id==t.post_like.postId?Object(u.a)(Object(u.a)({},e),{},{likes:c}):Object(u.a)({},e)})),a=Object(u.a)(Object(u.a)({},e),{},{posts:o});return a;case A:console.log("case COMMENT_ADD");var i=e.posts.map((function(e){if(e.id==t.comment_obj.postId){var n=[].concat(Object(re.a)(e.commentList),[t.comment_obj]);return Object(u.a)(Object(u.a)({},e),{},{commentList:n})}return e}));return Object(u.a)(Object(u.a)({},e),{},{posts:i});default:return e}},ie=Object(ne.b)({feedState:ae}),le=Object(ce.createLogger)(),ue=Object(ne.c)(ie,Object(ne.a)(se.a,le));o.a.render(Object(h.jsx)(c.a,{store:ue,children:Object(h.jsx)(te,{})}),document.getElementById("root"))}},[[94,1,2]]]);
//# sourceMappingURL=main.ca1395f9.chunk.js.map